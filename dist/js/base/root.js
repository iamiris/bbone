define(["base/view","base/app","widgets/header"],function(e,t,n){var r,i,s=function(e,n,i){console.log("renderPage",e,n,i),r&&r.remove(),require(["apps/"+e+"/pages/"+n],function(e){var n=new e.View({model:new e.Model(i)}),s=$(t.appBody);s.empty(),s.html(n.el),n.render(),r=n})},o=e.extend({postRender:function(){var e=new n.View({el:this.$("#header"),model:this.model});e.render()},changeHandler:function(e){var t=this,n=t.model.toJSON();console.log(e),e.hasOwnProperty("appId")?require(["apps/"+n.appId],function(){require(["apps/"+n.appId+"/app"],function(e){i&&i.tearApp(),e.setupApp(function(){n.hasOwnProperty("pageId")?s(n.appId,n.pageId,n):t.model.set("pageId",e.defaultPage)}),i=e})}):e.hasOwnProperty("pageId")?require(["apps/"+n.appId+"/app"],function(r){e.pageId===undefined?(t.model.set("pageId",r.defaultPage),n=t.model.toJSON()):s(n.appId,n.pageId,n)}):r&&r.model.reset(n)},preRendered:!0});return{View:o}});