define(["base/view","base/app","widgets/header"],function(e,t,n){var r,i=function(e,n,i){r&&r.remove(),require(["apps/"+e+"/pages/"+n],function(e){var n=new e.View({model:new e.Model(i)}),s=$(t.appBody);s.empty(),s.html(n.el),n.render(),r=n})},s=e.extend({changeHandler:function(e){var t=this,n=t.model.toJSON();e.hasOwnProperty("appId")?require(["apps/"+n.appId],function(){require(["apps/"+n.appId+"/app"],function(e){n.hasOwnProperty("pageId")||(t.model.set("pageId",e.defaultPage),n=t.model.toJSON()),i(n.appId,n.pageId,n)})}):e.hasOwnProperty("pageId")?require(["apps/"+n.appId+"/app"],function(e){i(n.appId,n.pageId,n)}):r&&r.model.reset(n)}});return{View:s}});