define([],function(){var e=Backbone.Model.extend({reset:function(e,t,n){var r,i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,u=n.silent,o=[],a=this._changing,this._changing=!0,a||(this._previousAttributes=_.clone(this.attributes),this.changed={}),l=this.attributes,f=this._previousAttributes,c=_.omit(this._previousAttributes,_.keys(i)),this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in c)t=i[r],_.isEqual(l[r],t)||o.push(r),_.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,delete l[r];for(r in i)t=i[r],_.isEqual(l[r],t)||o.push(r),_.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete l[r]:l[r]=t;if(!u){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,l[o[h]],n)}if(a)return this;if(!u)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this}});return e});